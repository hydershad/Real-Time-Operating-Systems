
	AREA |.text|, CODE, READONLY, ALIGN=2

	THUMB
	;EXPORT	OS
	EXTERN RunPt
	
OS_Suspend CPSID I
	PUSH {R4-R11}
	LDR R0, =RunPt
	LDR R1, [R0]
	STR SP, [R1]
	LDR R1, [R1, #4]
	STR R1, [R0]
	LDR SP, [R11]
	POP {R4-R11}
	CPSIE I
	BX LR

StartOS LDR R0, =RunPt
	LDR R2, [R0]
	LDR SP, [R2]
	POP {R4-R11}
	POP {R0-R3}
	POP {R12}
	POP {LR}
	POP {LR}
	POP {R1}
	CPSIE I
	BX LR


	ALIGN
	END